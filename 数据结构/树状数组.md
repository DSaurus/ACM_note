# 树状数组

## CF Goodbye2018 E.

### 题意

基于由度数生成图的问题，给定n个点，告诉你每个点的度数，同时有一个额外点不知道它的度数，如果这些点可以生成一个无重边和自环的图，问这个额外点的度数可能是多少。n为5e5的大小

### 题解

考虑最佳的匹配方案，使得额外点的度数最小。那么一定是当前度数最大的那个点去匹配度数次大的点，然而如果这么暴力贪心，是一定会TLE的。

那么先排序，从度数最大的点考虑，这个点的度数一定要通过匹配化成0或者1。最佳匹配要求尽量匹配成0，实在不行1也是可以的。

一个可行的方案就是用最大的和连续的k个最大的点匹配，同时维持序列的有序性，对于这k个中最小的点，只取左边的部分。比如2 2 2 3 3 4，消掉4就会变成1 1 2 2 2 （也就是对2来说，取左边部分，其他正常取）

我们注意到，当一个点无法被消成0或1时，并不意味着是无解的，我们可以把之前消成的0，分配给那个额外点，这样等价于对当前这个点减1。加入这个特殊讨论后，我们就能求出一个最佳的匹配方案（剩余数列中的1个数就是最小的度）。

整个过程可以用差分树状数组来解决，对于找到那个数的区间，也可以利用在树状数组上二分实现。

最大的度就只需要去求剩余数列中有多少个0可以被还原成1（每次选2个点，同时加1，答案加2）就可以了，因为我们是从右边度最大的点开始，在化简的过程中同时求合法0的个数就可以了。

[代码]{https://github.com/DSaurus/ACM_note/blob/master/data/cf_goodbye2018_e.cpp}